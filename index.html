<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üîç Th√°m t·ª≠ Nh·∫≠n d·∫°ng ƒê·ªông v·∫≠t AI</title>

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

  <style>
    :root{
      --primary:#0b63d1;
      --accent:#17a2b8;
      --success:#28a745;
      --bg:#f6f9fc;
      --card:#ffffff;
      --muted:#6c757d;
      --radius:12px;
      --shadow: 0 6px 18px rgba(14, 35, 78, 0.08);
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg, #f8fbff 0%, var(--bg) 100%);
      color:#222;
      padding:20px;
      -webkit-font-smoothing:antialiased;
    }

    .header {
      max-width:980px;
      margin: 6px auto 18px;
      text-align:center;
    }
    h1 {
      font-size:28px;
      margin:6px 0 6px;
      color:var(--primary);
      letter-spacing:0.2px;
      line-height:1.05;
    }
    .subtitle {
      color:var(--muted);
      margin:0 0 14px;
      font-weight:600;
    }

    .controls {
      max-width:980px;
      margin:0 auto 18px;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }
    button {
      border:0;
      background:var(--success);
      color:#fff;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      box-shadow:var(--shadow);
    }
    button.btn-upload { background:var(--accent); }
    button.btn-library { background:#6f42c1; }

    .container {
      max-width:980px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:18px;
      align-items:start;
    }

    /* Left column: webcam / preview + labels */
    .left {
      background:var(--card);
      border-radius:var(--radius);
      padding:14px;
      box-shadow:var(--shadow);
    }
    #webcam-container { display:flex; justify-content:center; align-items:center; min-height:220px; background:linear-gradient(180deg, #fff, #fafcff); border-radius:8px; padding:8px; }
    video,img,canvas{ max-width:100%; border-radius:8px; display:block; }

    #label-container { margin-top:12px; background:linear-gradient(180deg,#fff,#fbfcff); padding:10px; border-radius:8px; }
    #label-container div { padding:6px 0; border-bottom:1px dashed #eee; font-weight:600; color:#333; }

    /* Right column: khoa h·ªçc info + stats */
    .right {
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .card {
      background:var(--card);
      border-radius:var(--radius);
      padding:12px;
      box-shadow:var(--shadow);
      text-align:left;
    }

    .phan-hoi-khoa-hoc h2 { margin:0 0 8px; color:var(--primary); }
    .phan-hoi-khoa-hoc p { margin:0; color:#111; line-height:1.45; white-space:pre-wrap; }

    /* Stats */
    .stats-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:6px; }
    .stat {
      background:linear-gradient(180deg,#fff,#fbfcff);
      padding:12px;
      border-radius:10px;
      text-align:center;
      box-shadow:0 6px 12px rgba(12,34,78,0.06);
    }
    .stat .num { font-size:20px; font-weight:700; color:var(--primary); }
    .stat .label { font-size:12px; color:var(--muted); margin-top:6px; }

    /* Popup */
    .popup-overlay{position:fixed;inset:0;background:rgba(4,10,20,0.45);display:none;align-items:center;justify-content:center;z-index:9999;padding:20px}
    .popup-overlay.show{display:flex}
    .popup{background:var(--card);border-radius:12px;max-width:640px;width:100%;padding:18px;box-shadow:var(--shadow);text-align:left;max-height:80vh;overflow:auto}
    .popup h3{margin:0 0 12px 0;color:var(--primary)}
    .popup .info{white-space:pre-wrap;line-height:1.45;color:#222}

    /* Library overlay */
    .library-overlay{position:fixed;inset:0;background:rgba(4,10,20,0.45);display:none;z-index:10001;padding:18px;overflow:auto}
    .library-overlay.show{display:block}
    .library{max-width:980px;margin:30px auto;background:var(--card);border-radius:12px;padding:16px;box-shadow:var(--shadow)}

    .library .header { display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .record{display:flex;gap:12px;padding:12px;border-bottom:1px solid #f1f4f8;align-items:center}
    .record img{width:120px;height:auto;border-radius:8px;object-fit:cover}
    .record .meta{flex:1;text-align:left;font-size:0.95em}
    .record .meta b{display:block;color:var(--primary)}

    @media (max-width:980px) {
      .container { grid-template-columns: 1fr; }
      .right { order:2; }
      .left { order:1; }
      .stats-grid { grid-template-columns: repeat(2,1fr); }
    }
    @media (max-width:520px) {
      .stats-grid { grid-template-columns: 1fr; }
      h1 { font-size:20px; }
    }
  </style>
</head>
<body>

  <header class="header">
    <h1>Th√°m t·ª≠ AI<span style="display:block;font-size:20px; margin-top:6px; color:var(--muted)">Nh·∫≠n d·∫°ng ƒê·ªông v·∫≠t</span></h1>
    <div class="subtitle">Gi√°o vi√™n: Nguy·ªÖn Th·ªã Th√∫y An</div>
    <div class="subtitle">Tr∆∞·ªùng Ti·ªÉu h·ªçc B H√≤a L·∫°c</div>
  </header>

  <div class="controls">
    <button id="start-button" hidden>B·∫Øt ƒë·∫ßu (Camera sau)</button>
    <button id="upload-button" class="btn-upload">Ch·ª•p/T·∫£i ·∫£nh l√™n</button>
    <button id="library-button" class="btn-library">Th∆∞ vi·ªán</button>
    <button id="camera-button" hidden>Quay l·∫°i Camera</button>
    <input type="file" id="file-input" accept="image/*" style="display:none" />
  </div>

  <main class="container">
    <section class="left card">
      <div id="webcam-container">
        <div style="color:var(--muted);">Ch∆∞a c√≥ ·∫£nh ‚Äî ch·ªçn "Ch·ª•p/T·∫£i ·∫£nh l√™n"</div>
      </div>

      <div id="label-container"></div>
    </section>

    <aside class="right">
      <div class="card phan-hoi-khoa-hoc">
        <h2>üí° Th√¥ng tin Khoa h·ªçc v·ªÅ Lo√†i v·∫≠t</h2>
        <p id="khoa-hoc-info">Nh·∫•n "Ch·ª•p/T·∫£i ·∫£nh l√™n" ƒë·ªÉ cho AI th·∫•y m·ªôt lo√†i v·∫≠t v√† b·∫Øt ƒë·∫ßu ph√¢n t√≠ch...</p>
        <div id="status-line" class="status">S·∫µn s√†ng.</div>
      </div>

      <div class="card">
        <h3 style="margin:0 0 8px;color:var(--primary)">Th·ªëng k√™ nhanh</h3>
        <div class="stats-grid">
          <div class="stat">
            <div class="num" id="stat-students">‚Äî</div>
            <div class="label">T·ªïng s·ªë h·ªçc sinh tham gia</div>
          </div>
          <div class="stat">
            <div class="num" id="stat-recognitions">‚Äî</div>
            <div class="label">T·ªïng s·ªë l·∫ßn nh·∫≠n d·∫°ng</div>
          </div>
          <div class="stat">
            <div class="num" id="stat-visits">‚Äî</div>
            <div class="label">T·ªïng s·ªë l∆∞·ª£t truy c·∫≠p</div>
          </div>
        </div>
        <div style="margin-top:10px;color:var(--muted);font-size:13px">S·ªë li·ªáu c·∫≠p nh·∫≠t khi m·ªü Th∆∞ vi·ªán ho·∫∑c truy v·∫•n th·ªëng k√™ (t·ª± ƒë·ªông khi trang t·∫£i).</div>
      </div>
    </aside>
  </main>

  <!-- popup -->
  <div id="popup-overlay" class="popup-overlay" aria-hidden="true">
    <div class="popup" id="popup">
      <h3 id="popup-title">LO√ÄI: ??? <span id="popup-percent" style="font-weight:700;color:var(--success);margin-left:6px"></span></h3>
      <div class="info" id="popup-info"></div>
      <div style="text-align:right;margin-top:12px;"><button id="popup-close">ƒê√≥ng</button></div>
    </div>
  </div>

  <!-- student modal -->
  <div id="student-modal" class="modal" aria-hidden="true">
    <div class="card">
      <h3>Nh·∫≠p th√¥ng tin h·ªçc sinh</h3>
      <label>H·ªç v√† t√™n</label>
      <input id="student-name" type="text" placeholder="V√≠ d·ª•: Nguy·ªÖn VƒÉn A" />
      <label>L·ªõp</label>
      <input id="student-class" type="text" placeholder="V√≠ d·ª•: 4A" />
      <div style="text-align:right;"><button id="student-save">L∆∞u</button></div>
    </div>
  </div>

  <!-- library overlay -->
  <div id="library-overlay" class="library-overlay" aria-hidden="true">
    <div class="library">
      <div class="header">
        <h3>Th∆∞ vi·ªán nh·∫≠n d·∫°ng (chung)</h3>
        <div>
          <!-- ch·ªâ c√≤n n√∫t ƒê√≥ng nh∆∞ b·∫°n y√™u c·∫ßu -->
          <button id="library-close" style="background:#6c757d">ƒê√≥ng</button>
        </div>
      </div>
      <div id="library-list" style="margin-top:12px"></div>
    </div>
  </div>

<script>
/* ========== CONFIG ========== */
const CLOUDINARY_CLOUD_NAME = 'dlb55gph5';
const CLOUDINARY_UNSIGNED_UPLOAD_PRESET = 'unsigned_preset'; // <-- thay b·∫±ng t√™n preset c·ªßa b·∫°n
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby4yutRQG9iOWB5muCPxVuWx_m8Qk9q-lSp3NGkkuTYChNOSB1teDAWlkT8Ei2ruGgZ9A/exec';
const MODEL_URL = "https://teachablemachine.withgoogle.com/models/I2s7iGcQr/";

/* ========== STATE & DOM ========== */
let model = null, maxPredictions = 0;
let currentStream = null, videoElem = null, uploadedImageElem = null, uploadedFile = null;
let smallPredictSize = 224;

const uploadBtn = document.getElementById('upload-button');
const fileInput = document.getElementById('file-input');
const libraryBtn = document.getElementById('library-button');
const libraryOverlay = document.getElementById('library-overlay');
const libraryList = document.getElementById('library-list');
const libraryClose = document.getElementById('library-close');

const popupOverlay = document.getElementById('popup-overlay');
const popupClose = document.getElementById('popup-close');
const popupTitle = document.getElementById('popup-title');
const popupPercent = document.getElementById('popup-percent');
const popupInfo = document.getElementById('popup-info');

const studentModal = document.getElementById('student-modal');
const studentSaveBtn = document.getElementById('student-save');
const studentNameInput = document.getElementById('student-name');
const studentClassInput = document.getElementById('student-class');

const statusLine = document.getElementById('status-line');
const infoElement = document.getElementById('khoa-hoc-info');
const labelContainer = document.getElementById('label-container');

const statStudents = document.getElementById('stat-students');
const statRecognitions = document.getElementById('stat-recognitions');
const statVisits = document.getElementById('stat-visits');

function setStatus(text, isError=false) {
  statusLine.textContent = text || '';
  statusLine.className = 'status' + (isError ? ' error' : '');
  console.log('[STATUS]', text);
}

/* ========== Student local storage ========== */
function getStudentInfo() {
  try { const r = localStorage.getItem('studentInfo'); return r?JSON.parse(r):null; } catch(e){ return null; }
}
function saveStudentInfoToDevice(obj) { localStorage.setItem('studentInfo', JSON.stringify(obj)); }
function ensureStudentInfoBeforeAction() {
  const s = getStudentInfo();
  if (!s || !s.name || !s.class) {
    studentModal.classList.add('show'); studentModal.setAttribute('aria-hidden','false'); return false;
  }
  return true;
}
studentSaveBtn.addEventListener('click', () => {
  const n=(studentNameInput.value||'').trim(); const c=(studentClassInput.value||'').trim();
  if(!n||!c){ alert('Vui l√≤ng nh·∫≠p h·ªç t√™n v√† l·ªõp h·ªçc.'); return; }
  saveStudentInfoToDevice({ name:n, class:c });
  studentModal.classList.remove('show'); studentModal.setAttribute('aria-hidden','true');
  setStatus('Th√¥ng tin h·ªçc sinh ƒë√£ l∆∞u.');
});

/* show student modal on first visit */
window.addEventListener('load', () => {
  const info=getStudentInfo();
  if(!info || !info.name || !info.class) {
    studentModal.classList.add('show'); studentModal.setAttribute('aria-hidden','false');
  }
  setStatus('S·∫µn s√†ng. Trang ƒëang t·∫£i m√¥ h√¨nh trong n·ªÅn...');
  ensureModelLoaded().catch(err=>console.warn('Model preload failed',err));
  // increment global visit counter (JSONP) then refresh stats
  incrementVisit().finally(()=> fetchAndRenderStats());
});

/* ========== Model load ========== */
async function ensureModelLoaded() {
  if (model) return;
  try {
    setStatus('ƒêang t·∫£i m√¥ h√¨nh...');
    model = await tmImage.load(MODEL_URL + 'model.json', MODEL_URL + 'metadata.json');
    maxPredictions = model.getTotalClasses();
    labelContainer.innerHTML = '';
    for(let i=0;i<maxPredictions;i++) labelContainer.appendChild(document.createElement('div'));
    setStatus('M√¥ h√¨nh ƒë√£ s·∫µn s√†ng.');
  } catch(err){ console.error('Model load error', err); setStatus('L·ªói khi t·∫£i m√¥ h√¨nh (xem console).', true); throw err; }
}

/* ========== Camera helpers (kept) ========== */
async function stopCurrentStream() { if(currentStream) try{currentStream.getTracks().forEach(t=>t.stop())}catch(e){} currentStream=null; if(videoElem){ try{videoElem.pause()}catch(e){} if(videoElem.srcObject) videoElem.srcObject=null; try{videoElem.remove()}catch(e){} videoElem=null;} document.getElementById('webcam-container').innerHTML=''; }
async function attachStreamToVideo(stream){ currentStream=stream; const video=document.createElement('video'); video.setAttribute('playsinline',''); video.playsInline=true; video.muted=true; video.autoplay=true; video.width=300; video.height=300; video.style.maxWidth='100%'; video.srcObject=stream; await video.play(); videoElem=video; document.getElementById('webcam-container').innerHTML=''; document.getElementById('webcam-container').appendChild(videoElem); window.requestAnimationFrame(loop); }
async function startCamera(facingMode='environment'){ try{ await ensureModelLoaded(); if(typeof stopCurrentStream==='function') await stopCurrentStream(); setStatus('ƒêang k·∫øt n·ªëi camera...'); const devs = await navigator.mediaDevices.enumerateDevices().catch(()=>[]); let deviceId=null; const vids = devs.filter(d=>d.kind==='videoinput'); if(vids.length){ const prefer = vids.find(d=>d.label && /rear|back|environment|main/i.test(d.label)); deviceId = prefer ? prefer.deviceId : vids[vids.length-1].deviceId; } if(deviceId){ try{ const stream = await navigator.mediaDevices.getUserMedia({ video:{ deviceId:{ exact: deviceId } }, audio:false }); await attachStreamToVideo(stream); return; }catch(e){console.warn(e);} } try{ const stream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode:{ ideal: facingMode } }, audio:false }); await attachStreamToVideo(stream); }catch(e){ console.error('startCamera error',e); setStatus('Kh√¥ng th·ªÉ truy c·∫≠p camera: '+(e.message||e), true);} }catch(e){ console.error(e); setStatus('L·ªói camera/model (xem console).', true); } }

/* ========== Upload & predict flow ========== */
uploadBtn.addEventListener('click', ()=>fileInput.click());
fileInput.addEventListener('change', async (ev)=> {
  try {
    const file = ev.target.files && ev.target.files[0]; if(!file) return;
    uploadedFile = file;
    await ensureModelLoaded();
    if(typeof stopCurrentStream==='function') await stopCurrentStream();
    const reader = new FileReader();
    reader.onload = async (evt) => {
      const dataURL = evt.target.result;
      const img = document.createElement('img'); img.src=dataURL; img.alt='Uploaded image'; img.width=300; img.height=300; img.style.maxWidth='100%';
      document.getElementById('webcam-container').innerHTML=''; document.getElementById('webcam-container').appendChild(img);
      uploadedImageElem = img;
      img.onload = async ()=> { setStatus('·∫¢nh ƒë√£ t·∫£i. ƒêang ph√¢n t√≠ch nhanh...'); await predictImageElement(img, { fast:true }); };
    };
    reader.readAsDataURL(file);
  } catch(err){ console.error('file input error',err); setStatus('L·ªói khi ƒë·ªçc file (xem console).', true); } finally { fileInput.value=''; }
});

/* ========== Helpers ========== */
function stripDiacritics(str){ if(!str) return str; return str.normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/ƒë/g,'d').replace(/ƒê/g,'D').trim(); }

/* infoMap: expand as needed; ensure long text preserved */
// Th√¥ng tin khoa h·ªçc (Vietnamese) ‚Äî bao g·ªìm c·∫£ key c√≥ d·∫•u v√† kh√¥ng d·∫•u
// D√°n object n√†y v√†o file JS c·ªßa b·∫°n (v√≠ d·ª• g√°n v√†o bi·∫øn infoMap)
// C√°c m√¥ t·∫£ g·ªìm: t√™n ti·∫øng Vi·ªát, t√™n khoa h·ªçc (n·∫øu ph·ªï bi·∫øn), l·ªõp/nh√≥m, m√¥ t·∫£, m√¥i tr∆∞·ªùng s·ªëng, ch·∫ø ƒë·ªô ƒÉn, sinh s·∫£n, vai tr√≤ sinh th√°i v√† ghi ch√∫ b·∫£o t·ªìn.

const infoMap = {
  // B√≤
  "bo": "B√≤ (Bos taurus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫ (Mammalia). B√≤ l√† ƒë·ªông v·∫≠t nhai l·∫°i c√≥ k√≠ch th∆∞·ªõc l·ªõn, th√¢n h√¨nh ƒë·ªì s·ªô, b·ªën ch√¢n kh·ªèe v√† m√≥ng gu·ªëc. Ch√∫ng c√≥ h·ªá ti√™u h√≥a chuy√™n bi·ªát (d·∫° c·ªè 4 ngƒÉn) ƒë·ªÉ ti√™u h√≥a th·ª©c ƒÉn th√¥ nh∆∞ c·ªè. M√¥i tr∆∞·ªùng s·ªëng: ƒë·ªìng c·ªè, trang tr·∫°i, v√πng n√¥ng nghi·ªáp. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn c·ªè, th·ª±c v·∫≠t (ƒë·ªông v·∫≠t nhai l·∫°i). Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng m·ªôt con/l·ª©a, chƒÉm s√≥c con b·∫±ng s·ªØa m·∫π. Vai tr√≤ sinh th√°i: l√† ƒë·ªông v·∫≠t ti√™u th·ª• s∆° c·∫•p, ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn c·∫•u tr√∫c th·∫£m th·ª±c v·∫≠t; ƒë√≥ng g√≥p cho n·ªÅn n√¥ng nghi·ªáp (s·ªØa, th·ªãt, k√©o c√†y). Ghi ch√∫: gi·ªëng nu√¥i ƒë√£ ƒë∆∞·ª£c thu·∫ßn h√≥a; m·ªôt s·ªë qu·∫ßn th·ªÉ hoang d√£ c√≥ nguy c∆° do sƒÉn b·∫Øt v√† m·∫•t m√¥i tr∆∞·ªùng s·ªëng.",
  "b√≤": "B√≤ (Bos taurus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫ (Mammalia). B√≤ l√† ƒë·ªông v·∫≠t nhai l·∫°i c√≥ k√≠ch th∆∞·ªõc l·ªõn, th√¢n h√¨nh ƒë·ªì s·ªô, b·ªën ch√¢n kh·ªèe v√† m√≥ng gu·ªëc. Ch√∫ng c√≥ h·ªá ti√™u h√≥a chuy√™n bi·ªát (d·∫° c·ªè 4 ngƒÉn) ƒë·ªÉ ti√™u h√≥a th·ª©c ƒÉn th√¥ nh∆∞ c·ªè. M√¥i tr∆∞·ªùng s·ªëng: ƒë·ªìng c·ªè, trang tr·∫°i, v√πng n√¥ng nghi·ªáp. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn c·ªè, th·ª±c v·∫≠t (ƒë·ªông v·∫≠t nhai l·∫°i). Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng m·ªôt con/l·ª©a, chƒÉm s√≥c con b·∫±ng s·ªØa m·∫π. Vai tr√≤ sinh th√°i: l√† ƒë·ªông v·∫≠t ti√™u th·ª• s∆° c·∫•p, ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn c·∫•u tr√∫c th·∫£m th·ª±c v·∫≠t; ƒë√≥ng g√≥p cho n·ªÅn n√¥ng nghi·ªáp (s·ªØa, th·ªãt, k√©o c√†y). Ghi ch√∫: gi·ªëng nu√¥i ƒë√£ ƒë∆∞·ª£c thu·∫ßn h√≥a; m·ªôt s·ªë qu·∫ßn th·ªÉ hoang d√£ c√≥ nguy c∆° do sƒÉn b·∫Øt v√† m·∫•t m√¥i tr∆∞·ªùng s·ªëng.",

  // Tr√¢u
  "trau": "Tr√¢u n∆∞·ªõc (Bubalus bubalis) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Tr√¢u l√† ƒë·ªông v·∫≠t m√≥ng gu·ªëc, th∆∞·ªùng s·ªëng ·ªü v√πng ng·∫≠p n∆∞·ªõc, ƒë·ªìng l·∫ßy hay ru·ªông l√∫a; c∆° th·ªÉ to kh·ªèe, th√≠ch nghi t·ªët v·ªõi m√¥i tr∆∞·ªùng ·∫©m. Ch·∫ø ƒë·ªô ƒÉn: th·ª±c v·∫≠t, ƒë·∫∑c bi·ªát l√† c·ªè v√† c√¢y th·ªßy sinh. Sinh s·∫£n: gi·ªëng b√≤, ƒë·∫ª con; tr√¢u nu√¥i ph·ª•c v·ª• lao ƒë·ªông, s·ªØa v√† th·ªãt. Vai tr√≤: quan tr·ªçng trong n√¥ng nghi·ªáp truy·ªÅn th·ªëng (k√©o c√†y, l√†m ru·ªông). Ghi ch√∫: c√≥ nhi·ªÅu gi·ªëng thu·∫ßn h√≥a; qu·∫ßn th·ªÉ hoang d√£ (tr√¢u r·ª´ng) ·ªü m·ªôt s·ªë n∆°i b·ªã ƒëe d·ªça.",
  "tr√¢u": "Tr√¢u n∆∞·ªõc (Bubalus bubalis) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Tr√¢u l√† ƒë·ªông v·∫≠t m√≥ng gu·ªëc, th∆∞·ªùng s·ªëng ·ªü v√πng ng·∫≠p n∆∞·ªõc, ƒë·ªìng l·∫ßy hay ru·ªông l√∫a; c∆° th·ªÉ to kh·ªèe, th√≠ch nghi t·ªët v·ªõi m√¥i tr∆∞·ªùng ·∫©m. Ch·∫ø ƒë·ªô ƒÉn: th·ª±c v·∫≠t, ƒë·∫∑c bi·ªát l√† c·ªè v√† c√¢y th·ªßy sinh. Sinh s·∫£n: gi·ªëng b√≤, ƒë·∫ª con; tr√¢u nu√¥i ph·ª•c v·ª• lao ƒë·ªông, s·ªØa v√† th·ªãt. Vai tr√≤: quan tr·ªçng trong n√¥ng nghi·ªáp truy·ªÅn th·ªëng (k√©o c√†y, l√†m ru·ªông). Ghi ch√∫: c√≥ nhi·ªÅu gi·ªëng thu·∫ßn h√≥a; qu·∫ßn th·ªÉ hoang d√£ (tr√¢u r·ª´ng) ·ªü m·ªôt s·ªë n∆°i b·ªã ƒëe d·ªça.",

  // Heo
  "heo": "Heo (Sus scrofa domesticus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Heo l√† lo√†i ƒÉn t·∫°p, th√¢n tr√≤n, m≈©i c√πn, ch√¢n ng·∫Øn; c√≥ kh·∫£ nƒÉng th√≠ch nghi v·ªõi nhi·ªÅu m√¥i tr∆∞·ªùng s·ªëng. M√¥i tr∆∞·ªùng: trang tr·∫°i, b√°n hoang d√£. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p (th·ª±c v·∫≠t, c√¥n tr√πng, th·ª©c ƒÉn do con ng∆∞·ªùi cung c·∫•p). Sinh s·∫£n: m·ªói l·ª©a c√≥ nhi·ªÅu con, th·ªùi k·ª≥ mang thai ~114 ng√†y; chƒÉm s√≥c con b·∫±ng s·ªØa m·∫π. Vai tr√≤: ngu·ªìn th·ªãt (l·ª£n) v√† s·∫£n ph·∫©m n√¥ng nghi·ªáp; trong t·ª± nhi√™n, heo hoang ·∫£nh h∆∞·ªüng ƒë·∫øn c·∫•u tr√∫c th·∫£m th·ª±c v·∫≠t. Ghi ch√∫: heo nh√† ƒë√£ ƒë∆∞·ª£c thu·∫ßn h√≥a; v·∫•n ƒë·ªÅ d·ªãch b·ªánh (ASF) v√† ph√∫c l·ª£i chƒÉn nu√¥i l√† m·ªëi quan t√¢m.",
  
  // Ch√≥
  "cho": "Ch√≥ (Canis lupus familiaris) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Ch√≥ l√† lo√†i ƒë·ªông v·∫≠t ƒë√£ ƒë∆∞·ª£c thu·∫ßn h√≥a t·ª´ ch√≥ s√≥i; c√≥ k√≠ch th∆∞·ªõc v√† h√¨nh th√°i r·∫•t ƒëa d·∫°ng theo gi·ªëng. H√†nh vi x√£ h·ªôi cao, kh·∫£ nƒÉng h·ªçc t·∫≠p v√† h·ª£p t√°c v·ªõi con ng∆∞·ªùi. M√¥i tr∆∞·ªùng s·ªëng: ƒëa d·∫°ng ‚Äî nh√† c·ª≠a, n√¥ng th√¥n, ƒë√¥ th·ªã. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p, c√≥ th·ªÉ ti√™u th·ª• th·ª©c ƒÉn ch·∫ø bi·∫øn cho ch√≥. Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng v√†i con/l·ª©a; quan h·ªá x√£ h·ªôi ph·ª©c t·∫°p. Vai tr√≤: b·∫£o v·ªá, l√†m b·∫°n, d·∫´n ƒë∆∞·ªùng, h·ªó tr·ª£ c√¥ng vi·ªác. Ghi ch√∫: b·∫£o t·ªìn kh√¥ng √°p d·ª•ng cho ch√≥ nh√†; ch√≥ hoang/hoang d√£ c√≥ v·∫•n ƒë·ªÅ qu·∫£n l√Ω qu·∫ßn th·ªÉ.",
  "ch√≥": "Ch√≥ (Canis lupus familiaris) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Ch√≥ l√† lo√†i ƒë·ªông v·∫≠t ƒë√£ ƒë∆∞·ª£c thu·∫ßn h√≥a t·ª´ ch√≥ s√≥i; c√≥ k√≠ch th∆∞·ªõc v√† h√¨nh th√°i r·∫•t ƒëa d·∫°ng theo gi·ªëng. H√†nh vi x√£ h·ªôi cao, kh·∫£ nƒÉng h·ªçc t·∫≠p v√† h·ª£p t√°c v·ªõi con ng∆∞·ªùi. M√¥i tr∆∞·ªùng s·ªëng: ƒëa d·∫°ng ‚Äî nh√† c·ª≠a, n√¥ng th√¥n, ƒë√¥ th·ªã. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p, c√≥ th·ªÉ ti√™u th·ª• th·ª©c ƒÉn ch·∫ø bi·∫øn cho ch√≥. Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng v√†i con/l·ª©a; quan h·ªá x√£ h·ªôi ph·ª©c t·∫°p. Vai tr√≤: b·∫£o v·ªá, l√†m b·∫°n, d·∫´n ƒë∆∞·ªùng, h·ªó tr·ª£ c√¥ng vi·ªác. Ghi ch√∫: b·∫£o t·ªìn kh√¥ng √°p d·ª•ng cho ch√≥ nh√†; ch√≥ hoang/hoang d√£ c√≥ v·∫•n ƒë·ªÅ qu·∫£n l√Ω qu·∫ßn th·ªÉ.",

  // M√®o
  "meo": "M√®o (Felis catus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. M√®o nh√† l√† lo√†i th√∫ c∆∞ng ph·ªï bi·∫øn, c√≥ b·∫£n nƒÉng sƒÉn m·ªìi m·∫°nh m·∫Ω; h√¨nh th·ªÉ nh·ªè g·ªçn, linh ho·∫°t, c√≥ m√≥ng s·∫Øc v√† th·ªã l·ª±c t·ªët trong ƒëi·ªÅu ki·ªán √°nh s√°ng y·∫øu. M√¥i tr∆∞·ªùng s·ªëng: trong nh√†, khu ƒë√¥ th·ªã, n√¥ng th√¥n. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn th·ªãt/carnivorous (chu·ªôt, chim, c√¥n tr√πng); trong nu√¥i nh·ªët ƒë∆∞·ª£c cho ƒÉn th·ª©c ƒÉn ch·∫ø bi·∫øn. Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng 2‚Äì6 con/l·ª©a; chƒÉm s√≥c con trong th·ªùi gian ƒë·∫ßu. Vai tr√≤: ki·ªÉm so√°t chu·ªôt, b·∫°n ƒë·ªìng h√†nh. Ghi ch√∫: m√®o nh√† c√≥ th·ªÉ ·∫£nh h∆∞·ªüng t·ªõi ƒë·ªông v·∫≠t hoang d√£ nh·ªè n·∫øu th·∫£ r√¥ng.",
  "m√®o": "M√®o (Felis catus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. M√®o nh√† l√† lo√†i th√∫ c∆∞ng ph·ªï bi·∫øn, c√≥ b·∫£n nƒÉng sƒÉn m·ªìi m·∫°nh m·∫Ω; h√¨nh th·ªÉ nh·ªè g·ªçn, linh ho·∫°t, c√≥ m√≥ng s·∫Øc v√† th·ªã l·ª±c t·ªët trong ƒëi·ªÅu ki·ªán √°nh s√°ng y·∫øu. M√¥i tr∆∞·ªùng s·ªëng: trong nh√†, khu ƒë√¥ th·ªã, n√¥ng th√¥n. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn th·ªãt/carnivorous (chu·ªôt, chim, c√¥n tr√πng); trong nu√¥i nh·ªët ƒë∆∞·ª£c cho ƒÉn th·ª©c ƒÉn ch·∫ø bi·∫øn. Sinh s·∫£n: ƒë·∫ª con, th∆∞·ªùng 2‚Äì6 con/l·ª©a; chƒÉm s√≥c con trong th·ªùi gian ƒë·∫ßu. Vai tr√≤: ki·ªÉm so√°t chu·ªôt, b·∫°n ƒë·ªìng h√†nh. Ghi ch√∫: m√®o nh√† c√≥ th·ªÉ ·∫£nh h∆∞·ªüng t·ªõi ƒë·ªông v·∫≠t hoang d√£ nh·ªè n·∫øu th·∫£ r√¥ng.",

  // Chu·ªôt
  "chuot": "Chu·ªôt (Rodentia ‚Äî nhi·ªÅu chi, v√≠ d·ª• Rattus, Mus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Chu·ªôt l√† lo√†i g·∫∑m nh·∫•m c√≥ k√≠ch th∆∞·ªõc nh·ªè ƒë·∫øn trung b√¨nh, rƒÉng c·ª≠a ph√°t tri·ªÉn li√™n t·ª•c ƒë·ªÉ g·∫∑m nh·∫•m. M√¥i tr∆∞·ªùng s·ªëng: m√¥i tr∆∞·ªùng ƒë·ªìng ru·ªông, ƒë√¥ th·ªã, nh√† c·ª≠a, r·ª´ng... Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p ‚Äî h·∫°t, tr√°i c√¢y, th·ª±c ph·∫©m th·ª´a, th·∫≠m ch√≠ x√°c b√£ h·ªØu c∆°. Sinh s·∫£n: ƒë·∫ª nhi·ªÅu con, v√≤ng ƒë·ªùi nhanh, sinh s·∫£n li√™n t·ª•c theo ƒëi·ªÅu ki·ªán. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆°, ngu·ªìn th·ª©c ƒÉn cho nhi·ªÅu lo√†i sƒÉn m·ªìi, nh∆∞ng c≈©ng l√† v·∫≠t truy·ªÅn b·ªánh v√† g√¢y h·∫°i n√¥ng nghi·ªáp. Ghi ch√∫: ki·ªÉm so√°t qu·∫ßn th·ªÉ c·∫ßn an to√†n sinh h·ªçc ƒë·ªÉ tr√°nh d·ªãch b·ªánh.",
  "chu·ªôt": "Chu·ªôt (Rodentia ‚Äî nhi·ªÅu chi, v√≠ d·ª• Rattus, Mus) ‚Äî L·ªõp: ƒê·ªông v·∫≠t c√≥ v√∫. Chu·ªôt l√† lo√†i g·∫∑m nh·∫•m c√≥ k√≠ch th∆∞·ªõc nh·ªè ƒë·∫øn trung b√¨nh, rƒÉng c·ª≠a ph√°t tri·ªÉn li√™n t·ª•c ƒë·ªÉ g·∫∑m nh·∫•m. M√¥i tr∆∞·ªùng s·ªëng: m√¥i tr∆∞·ªùng ƒë·ªìng ru·ªông, ƒë√¥ th·ªã, nh√† c·ª≠a, r·ª´ng... Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p ‚Äî h·∫°t, tr√°i c√¢y, th·ª±c ph·∫©m th·ª´a, th·∫≠m ch√≠ x√°c b√£ h·ªØu c∆°. Sinh s·∫£n: ƒë·∫ª nhi·ªÅu con, v√≤ng ƒë·ªùi nhanh, sinh s·∫£n li√™n t·ª•c theo ƒëi·ªÅu ki·ªán. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆°, ngu·ªìn th·ª©c ƒÉn cho nhi·ªÅu lo√†i sƒÉn m·ªìi, nh∆∞ng c≈©ng l√† v·∫≠t truy·ªÅn b·ªánh v√† g√¢y h·∫°i n√¥ng nghi·ªáp. Ghi ch√∫: ki·ªÉm so√°t qu·∫ßn th·ªÉ c·∫ßn an to√†n sinh h·ªçc ƒë·ªÉ tr√°nh d·ªãch b·ªánh.",

  // G√†
  "ga": "G√† (Gallus gallus domesticus) ‚Äî L·ªõp: Chim (Aves). G√† nh√† ƒë∆∞·ª£c thu·∫ßn h√≥a t·ª´ g√† r·ª´ng ƒë·ªè; c√≥ c∆° th·ªÉ nh·ªè ƒë·∫øn trung b√¨nh, l√¥ng v≈©, m·ªè kh·ªèe. M√¥i tr∆∞·ªùng: trang tr·∫°i, v∆∞·ªùn nh√†. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p ‚Äî h·∫°t ng≈© c·ªëc, c√¥n tr√πng, th·ª©c ƒÉn h·ªón h·ª£p. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; ·∫•p tr·ª©ng t·∫°o con m·ªõi. Vai tr√≤: cung c·∫•p tr·ª©ng, th·ªãt; tham gia v√†o h·ªá sinh th√°i n√¥ng nghi·ªáp b·∫±ng c√°ch ki·ªÉm so√°t c√¥n tr√πng. Ghi ch√∫: nhi·ªÅu gi·ªëng nu√¥i v·ªõi m·ª•c ƒë√≠ch kh√°c nhau (tr·ª©ng, th·ªãt, c·∫£nh).",
  "g√†": "G√† (Gallus gallus domesticus) ‚Äî L·ªõp: Chim (Aves). G√† nh√† ƒë∆∞·ª£c thu·∫ßn h√≥a t·ª´ g√† r·ª´ng ƒë·ªè; c√≥ c∆° th·ªÉ nh·ªè ƒë·∫øn trung b√¨nh, l√¥ng v≈©, m·ªè kh·ªèe. M√¥i tr∆∞·ªùng: trang tr·∫°i, v∆∞·ªùn nh√†. Ch·∫ø ƒë·ªô ƒÉn: ƒÉn t·∫°p ‚Äî h·∫°t ng≈© c·ªëc, c√¥n tr√πng, th·ª©c ƒÉn h·ªón h·ª£p. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; ·∫•p tr·ª©ng t·∫°o con m·ªõi. Vai tr√≤: cung c·∫•p tr·ª©ng, th·ªãt; tham gia v√†o h·ªá sinh th√°i n√¥ng nghi·ªáp b·∫±ng c√°ch ki·ªÉm so√°t c√¥n tr√πng. Ghi ch√∫: nhi·ªÅu gi·ªëng nu√¥i v·ªõi m·ª•c ƒë√≠ch kh√°c nhau (tr·ª©ng, th·ªãt, c·∫£nh).",

  // V·ªãt
  "vit": "V·ªãt (Anas platyrhynchos domesticus v√† c√°c lo√†i li√™n quan) ‚Äî L·ªõp: Chim (Aves). V·ªãt nu√¥i th∆∞·ªùng s·ªëng g·∫ßn n∆∞·ªõc, c√≥ m√†ng ch√¢n b∆°i, m·ªè d·∫πt th√≠ch nghi ƒë·ªÉ ƒë√†o b·ªõi th·ª©c ƒÉn trong n∆∞·ªõc. M√¥i tr∆∞·ªùng: ao h·ªì, ru·ªông l√∫a, ao nu√¥i. Ch·∫ø ƒë·ªô ƒÉn: th·ª±c v·∫≠t n∆∞·ªõc, h·∫°t, c√¥n tr√πng nh·ªè. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; nu√¥i con non t·ª± l·∫≠p s·ªõm. Vai tr√≤: ngu·ªìn th·ª±c ph·∫©m (th·ªãt, tr·ª©ng), nu√¥i th·ªßy s·∫£n k·∫øt h·ª£p. Ghi ch√∫: m·ªôt s·ªë lo√†i v·ªãt hoang d√£ c√≥ gi√° tr·ªã b·∫£o t·ªìn.",
  "v·ªãt": "V·ªãt (Anas platyrhynchos domesticus v√† c√°c lo√†i li√™n quan) ‚Äî L·ªõp: Chim (Aves). V·ªãt nu√¥i th∆∞·ªùng s·ªëng g·∫ßn n∆∞·ªõc, c√≥ m√†ng ch√¢n b∆°i, m·ªè d·∫πt th√≠ch nghi ƒë·ªÉ ƒë√†o b·ªõi th·ª©c ƒÉn trong n∆∞·ªõc. M√¥i tr∆∞·ªùng: ao h·ªì, ru·ªông l√∫a, ao nu√¥i. Ch·∫ø ƒë·ªô ƒÉn: th·ª±c v·∫≠t n∆∞·ªõc, h·∫°t, c√¥n tr√πng nh·ªè. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; nu√¥i con non t·ª± l·∫≠p s·ªõm. Vai tr√≤: ngu·ªìn th·ª±c ph·∫©m (th·ªãt, tr·ª©ng), nu√¥i th·ªßy s·∫£n k·∫øt h·ª£p. Ghi ch√∫: m·ªôt s·ªë lo√†i v·ªãt hoang d√£ c√≥ gi√° tr·ªã b·∫£o t·ªìn.",

  // Chim (chung)
  "chim": "Chim (Aves ‚Äî nh√≥m r·∫•t ƒëa d·∫°ng) ‚Äî L·ªõp: Chim. Chim l√† ƒë·ªông v·∫≠t c√≥ l√¥ng v≈©, ƒëa ph·∫ßn c√≥ kh·∫£ nƒÉng bay (kh√¥ng ph·∫£i t·∫•t c·∫£), ƒë·∫ª tr·ª©ng v√† c√≥ c·∫•u tr√∫c m·ªè bi·∫øn ƒë·ªïi theo ch·∫ø ƒë·ªô ƒÉn. M√¥i tr∆∞·ªùng s·ªëng: t·ª´ r·ª´ng ƒë·∫øn ƒë√¥ th·ªã, n√∫i, ƒë·ªìng b·∫±ng, v√πng n∆∞·ªõc. Ch·∫ø ƒë·ªô ƒÉn: ƒëa d·∫°ng (h·∫°t, tr√°i c√¢y, c√¥n tr√πng, m·ªìi nh·ªè). Sinh s·∫£n: ƒë·∫ª tr·ª©ng; nhi·ªÅu lo√†i x√¢y t·ªï v√† nu√¥i con. Vai tr√≤: th·ª• ph·∫•n, gieo r·∫Øc h·∫°t, ki·ªÉm so√°t c√¥n tr√πng, ch·ªâ b√°o ƒëa d·∫°ng sinh h·ªçc. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh lo√†i ƒë·ªÉ th√¥ng tin chi ti·∫øt h∆°n.",
  "chim": "Chim (Aves ‚Äî nh√≥m r·∫•t ƒëa d·∫°ng) ‚Äî L·ªõp: Chim. Chim l√† ƒë·ªông v·∫≠t c√≥ l√¥ng v≈©, ƒëa ph·∫ßn c√≥ kh·∫£ nƒÉng bay (kh√¥ng ph·∫£i t·∫•t c·∫£), ƒë·∫ª tr·ª©ng v√† c√≥ c·∫•u tr√∫c m·ªè bi·∫øn ƒë·ªïi theo ch·∫ø ƒë·ªô ƒÉn. M√¥i tr∆∞·ªùng s·ªëng: t·ª´ r·ª´ng ƒë·∫øn ƒë√¥ th·ªã, n√∫i, ƒë·ªìng b·∫±ng, v√πng n∆∞·ªõc. Ch·∫ø ƒë·ªô ƒÉn: ƒëa d·∫°ng (h·∫°t, tr√°i c√¢y, c√¥n tr√πng, m·ªìi nh·ªè). Sinh s·∫£n: ƒë·∫ª tr·ª©ng; nhi·ªÅu lo√†i x√¢y t·ªï v√† nu√¥i con. Vai tr√≤: th·ª• ph·∫•n, gieo r·∫Øc h·∫°t, ki·ªÉm so√°t c√¥n tr√πng, ch·ªâ b√°o ƒëa d·∫°ng sinh h·ªçc. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh lo√†i ƒë·ªÉ th√¥ng tin chi ti·∫øt h∆°n.",

  // C√°
  "ca": "C√° (Pisces ‚Äî nh√≥m r·∫•t ƒëa d·∫°ng) ‚Äî L·ªõp: C√°. C√° s·ªëng ch·ªß y·∫øu d∆∞·ªõi n∆∞·ªõc, h√¥ h·∫•p b·∫±ng mang, b∆°i b·∫±ng v√¢y; k√≠ch th∆∞·ªõc v√† h√¨nh th√°i r·∫•t ƒëa d·∫°ng t√πy lo√†i. M√¥i tr∆∞·ªùng s·ªëng: n∆∞·ªõc ng·ªçt, n∆∞·ªõc m·∫∑n, n∆∞·ªõc l·ª£. Ch·∫ø ƒë·ªô ƒÉn: t·ª´ th·ª±c v·∫≠t (th·ª±c v·∫≠t ph√π du) ƒë·∫øn ƒë·ªông v·∫≠t (c√¥n tr√πng, t√¥m, c√° nh·ªè). Sinh s·∫£n: ph·∫ßn l·ªõn ƒë·∫ª tr·ª©ng, m·ªôt v√†i lo√†i nu√¥i con theo m·ªôt s·ªë m·ª©c ƒë·ªô. Vai tr√≤: m·∫Øt x√≠ch quan tr·ªçng trong chu·ªói th·ª©c ƒÉn th·ªßy sinh, ngu·ªìn th·ª±c ph·∫©m cho con ng∆∞·ªùi. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh h·ªç/lo√†i ƒë·ªÉ m√¥ t·∫£ ch√≠nh x√°c.",
  "c√°": "C√° (Pisces ‚Äî nh√≥m r·∫•t ƒëa d·∫°ng) ‚Äî L·ªõp: C√°. C√° s·ªëng ch·ªß y·∫øu d∆∞·ªõi n∆∞·ªõc, h√¥ h·∫•p b·∫±ng mang, b∆°i b·∫±ng v√¢y; k√≠ch th∆∞·ªõc v√† h√¨nh th√°i r·∫•t ƒëa d·∫°ng t√πy lo√†i. M√¥i tr∆∞·ªùng s·ªëng: n∆∞·ªõc ng·ªçt, n∆∞·ªõc m·∫∑n, n∆∞·ªõc l·ª£. Ch·∫ø ƒë·ªô ƒÉn: t·ª´ th·ª±c v·∫≠t (th·ª±c v·∫≠t ph√π du) ƒë·∫øn ƒë·ªông v·∫≠t (c√¥n tr√πng, t√¥m, c√° nh·ªè). Sinh s·∫£n: ph·∫ßn l·ªõn ƒë·∫ª tr·ª©ng, m·ªôt v√†i lo√†i nu√¥i con theo m·ªôt s·ªë m·ª©c ƒë·ªô. Vai tr√≤: m·∫Øt x√≠ch quan tr·ªçng trong chu·ªói th·ª©c ƒÉn th·ªßy sinh, ngu·ªìn th·ª±c ph·∫©m cho con ng∆∞·ªùi. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh h·ªç/lo√†i ƒë·ªÉ m√¥ t·∫£ ch√≠nh x√°c.",

  // ·∫æch
  "ech": "·∫æch (Anura ‚Äî c√°c lo√†i thu·ªôc h·ªç Ranidae v√† kh√°c) ‚Äî L·ªõp: L∆∞·ª°ng c∆∞ (Amphibia). ·∫æch c√≥ th√¢n ng·∫Øn, ch√¢n sau kh·ªèe ƒë·ªÉ nh·∫£y, da ·∫©m; v√≤ng ƒë·ªùi th∆∞·ªùng c√≥ giai ƒëo·∫°n n√≤ng n·ªçc (·∫•u tr√πng s·ªëng d∆∞·ªõi n∆∞·ªõc). M√¥i tr∆∞·ªùng s·ªëng: ao, ƒë·∫ßm, v√πng ·∫©m ∆∞·ªõt, r·ª´ng. Ch·∫ø ƒë·ªô ƒÉn: c√¥n tr√πng v√† ƒë·ªông v·∫≠t kh√¥ng x∆∞∆°ng s·ªëng nh·ªè (duy tr√¨ vai tr√≤ ki·ªÉm so√°t c√¥n tr√πng). Sinh s·∫£n: ƒë·∫ª tr·ª©ng ·ªü n∆∞·ªõc; ph√°t tri·ªÉn qua giai ƒëo·∫°n n√≤ng n·ªçc. Vai tr√≤: ch·ªâ b√°o s·ª©c kh·ªèe m√¥i tr∆∞·ªùng do da nh·∫°y c·∫£m v·ªõi √¥ nhi·ªÖm. Ghi ch√∫: nhi·ªÅu lo√†i ·∫øch ƒëang suy gi·∫£m do m·∫•t m√¥i tr∆∞·ªùng s·ªëng v√† √¥ nhi·ªÖm.",
  "·∫øch": "·∫æch (Anura ‚Äî c√°c lo√†i thu·ªôc h·ªç Ranidae v√† kh√°c) ‚Äî L·ªõp: L∆∞·ª°ng c∆∞ (Amphibia). ·∫æch c√≥ th√¢n ng·∫Øn, ch√¢n sau kh·ªèe ƒë·ªÉ nh·∫£y, da ·∫©m; v√≤ng ƒë·ªùi th∆∞·ªùng c√≥ giai ƒëo·∫°n n√≤ng n·ªçc (·∫•u tr√πng s·ªëng d∆∞·ªõi n∆∞·ªõc). M√¥i tr∆∞·ªùng s·ªëng: ao, ƒë·∫ßm, v√πng ·∫©m ∆∞·ªõt, r·ª´ng. Ch·∫ø ƒë·ªô ƒÉn: c√¥n tr√πng v√† ƒë·ªông v·∫≠t kh√¥ng x∆∞∆°ng s·ªëng nh·ªè (duy tr√¨ vai tr√≤ ki·ªÉm so√°t c√¥n tr√πng). Sinh s·∫£n: ƒë·∫ª tr·ª©ng ·ªü n∆∞·ªõc; ph√°t tri·ªÉn qua giai ƒëo·∫°n n√≤ng n·ªçc. Vai tr√≤: ch·ªâ b√°o s·ª©c kh·ªèe m√¥i tr∆∞·ªùng do da nh·∫°y c·∫£m v·ªõi √¥ nhi·ªÖm. Ghi ch√∫: nhi·ªÅu lo√†i ·∫øch ƒëang suy gi·∫£m do m·∫•t m√¥i tr∆∞·ªùng s·ªëng v√† √¥ nhi·ªÖm.",

  // R·∫Øn
  "ran": "R·∫Øn (Serpentes ‚Äî b·ªô B√≤ s√°t) ‚Äî L·ªõp: B√≤ s√°t (Reptilia). R·∫Øn c√≥ c∆° th·ªÉ d√†i, kh√¥ng chi; nhi·ªÅu lo√†i c√≥ v·∫£y v√† c√≥ c√°c ph∆∞∆°ng th·ª©c sƒÉn m·ªìi kh√°c nhau (m·ªôt s·ªë d√πng n·ªçc, m·ªôt s·ªë si·∫øt). M√¥i tr∆∞·ªùng s·ªëng: r·ª´ng, ƒë·ªìng c·ªè, sa m·∫°c, v√πng ƒë·∫•t ·∫©m; ph√¢n b·ªë r·ªông. Ch·∫ø ƒë·ªô ƒÉn: ch·ªß y·∫øu l√† ƒë·ªông v·∫≠t c√≥ x∆∞∆°ng s·ªëng nh·ªè (chu·ªôt, chim, l∆∞·ª°ng c∆∞) ho·∫∑c tr·ª©ng. Sinh s·∫£n: ƒë·∫ª tr·ª©ng ho·∫∑c ƒë·∫ª con t√πy lo√†i. Vai tr√≤: ki·ªÉm so√°t qu·∫ßn th·ªÉ ƒë·ªông v·∫≠t g·∫∑m nh·∫•m v√† c√¢n b·∫±ng h·ªá sinh th√°i. Ghi ch√∫: c·∫ßn nh·∫≠n di·ªán lo√†i ƒë·ªÉ ƒë√°nh gi√° m·ª©c ƒë·ªô nguy hi·ªÉm v√† b·∫£o t·ªìn.",
  "r·∫Øn": "R·∫Øn (Serpentes ‚Äî b·ªô B√≤ s√°t) ‚Äî L·ªõp: B√≤ s√°t (Reptilia). R·∫Øn c√≥ c∆° th·ªÉ d√†i, kh√¥ng chi; nhi·ªÅu lo√†i c√≥ v·∫£y v√† c√≥ c√°c ph∆∞∆°ng th·ª©c sƒÉn m·ªìi kh√°c nhau (m·ªôt s·ªë d√πng n·ªçc, m·ªôt s·ªë si·∫øt). M√¥i tr∆∞·ªùng s·ªëng: r·ª´ng, ƒë·ªìng c·ªè, sa m·∫°c, v√πng ƒë·∫•t ·∫©m; ph√¢n b·ªë r·ªông. Ch·∫ø ƒë·ªô ƒÉn: ch·ªß y·∫øu l√† ƒë·ªông v·∫≠t c√≥ x∆∞∆°ng s·ªëng nh·ªè (chu·ªôt, chim, l∆∞·ª°ng c∆∞) ho·∫∑c tr·ª©ng. Sinh s·∫£n: ƒë·∫ª tr·ª©ng ho·∫∑c ƒë·∫ª con t√πy lo√†i. Vai tr√≤: ki·ªÉm so√°t qu·∫ßn th·ªÉ ƒë·ªông v·∫≠t g·∫∑m nh·∫•m v√† c√¢n b·∫±ng h·ªá sinh th√°i. Ghi ch√∫: c·∫ßn nh·∫≠n di·ªán lo√†i ƒë·ªÉ ƒë√°nh gi√° m·ª©c ƒë·ªô nguy hi·ªÉm v√† b·∫£o t·ªìn.",

  // Th·∫±n l·∫±n / Th·∫±n l·∫±n (thanlan)
  "thanlan": "Th·∫±n l·∫±n (Lacertilia/various families) ‚Äî L·ªõp: B√≤ s√°t (Reptilia). Th·∫±n l·∫±n l√† nh√≥m ƒëa d·∫°ng g·ªìm nhi·ªÅu lo√†i c√≥ b·ªën ch√¢n, ƒëu√¥i d√†i, da v·∫£y; ho·∫°t ƒë·ªông b·∫±ng c√°ch t·∫Øm n·∫Øng ƒë·ªÉ ƒëi·ªÅu h√≤a nhi·ªát ƒë·ªô. M√¥i tr∆∞·ªùng: ƒë√°, r·ª´ng, sa m·∫°c, v∆∞·ªùn. Ch·∫ø ƒë·ªô ƒÉn: ch·ªß y·∫øu c√¥n tr√πng v√† ƒë·ªông v·∫≠t kh√¥ng x∆∞∆°ng s·ªëng (m·ªôt s·ªë lo√†i ƒÉn th·ª±c v·∫≠t). Sinh s·∫£n: ƒë·∫ª tr·ª©ng ho·∫∑c ƒë·∫ª con t√πy lo√†i. Vai tr√≤: ki·ªÉm so√°t c√¥n tr√πng, l√† m·ªìi cho ƒë·ªông v·∫≠t l·ªõn h∆°n. Ghi ch√∫: m·ªôt s·ªë lo√†i ƒë·ªôc ƒë√°o c√≥ kh·∫£ nƒÉng t·ª± ƒë·ª©t ƒëu√¥i ƒë·ªÉ tho√°t hi·ªÉm.",
  "th·∫±n l·∫±n": "Th·∫±n l·∫±n (Lacertilia/various families) ‚Äî L·ªõp: B√≤ s√°t (Reptilia). Th·∫±n l·∫±n l√† nh√≥m ƒëa d·∫°ng g·ªìm nhi·ªÅu lo√†i c√≥ b·ªën ch√¢n, ƒëu√¥i d√†i, da v·∫£y; ho·∫°t ƒë·ªông b·∫±ng c√°ch t·∫Øm n·∫Øng ƒë·ªÉ ƒëi·ªÅu h√≤a nhi·ªát ƒë·ªô. M√¥i tr∆∞·ªùng: ƒë√°, r·ª´ng, sa m·∫°c, v∆∞·ªùn. Ch·∫ø ƒë·ªô ƒÉn: ch·ªß y·∫øu c√¥n tr√πng v√† ƒë·ªông v·∫≠t kh√¥ng x∆∞∆°ng s·ªëng (m·ªôt s·ªë lo√†i ƒÉn th·ª±c v·∫≠t). Sinh s·∫£n: ƒë·∫ª tr·ª©ng ho·∫∑c ƒë·∫ª con t√πy lo√†i. Vai tr√≤: ki·ªÉm so√°t c√¥n tr√πng, l√† m·ªìi cho ƒë·ªông v·∫≠t l·ªõn h∆°n. Ghi ch√∫: m·ªôt s·ªë lo√†i ƒë·ªôc ƒë√°o c√≥ kh·∫£ nƒÉng t·ª± ƒë·ª©t ƒëu√¥i ƒë·ªÉ tho√°t hi·ªÉm.",

  // K√¨ nh√¥ng (k√¨ nh√¥ng / kinhong)
  "kinhong": "K√¨ nh√¥ng (Agamidae/Varanus family etc.) ‚Äî L·ªõp: B√≤ s√°t. 'K√¨ nh√¥ng' th∆∞·ªùng d√πng cho c√°c lo√†i th·∫±n l·∫±n l·ªõn nh∆∞ k·ª≥ nh√¥ng c√≥ ƒëu√¥i d√†i, th√¢n d·∫πt; m·ªôt s·ªë lo√†i (v√≠ d·ª• r·ªìng ƒë·∫•t) c√≥ m√†u s·∫Øc n·ªïi b·∫≠t. M√¥i tr∆∞·ªùng: r·ª´ng, v√πng n√∫i, b√°n hoang m·∫°c. Ch·∫ø ƒë·ªô ƒÉn: c√¥n tr√πng, ƒë·ªông v·∫≠t nh·ªè, ƒë√¥i khi tr√°i c√¢y. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; m·ªôt s·ªë lo√†i c√≥ h√†nh vi b·∫£o v·ªá t·ªï. Vai tr√≤: ƒÉn c√¥n tr√πng v√† g√≥p ph·∫ßn ƒëi·ªÅu h√≤a qu·∫ßn th·ªÉ. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh chi/lo√†i ƒë·ªÉ m√¥ t·∫£ ch√≠nh x√°c.",
  "k√¨ nh√¥ng": "K√¨ nh√¥ng (Agamidae/Varanus family etc.) ‚Äî L·ªõp: B√≤ s√°t. 'K√¨ nh√¥ng' th∆∞·ªùng d√πng cho c√°c lo√†i th·∫±n l·∫±n l·ªõn nh∆∞ k·ª≥ nh√¥ng c√≥ ƒëu√¥i d√†i, th√¢n d·∫πt; m·ªôt s·ªë lo√†i (v√≠ d·ª• r·ªìng ƒë·∫•t) c√≥ m√†u s·∫Øc n·ªïi b·∫≠t. M√¥i tr∆∞·ªùng: r·ª´ng, v√πng n√∫i, b√°n hoang m·∫°c. Ch·∫ø ƒë·ªô ƒÉn: c√¥n tr√πng, ƒë·ªông v·∫≠t nh·ªè, ƒë√¥i khi tr√°i c√¢y. Sinh s·∫£n: ƒë·∫ª tr·ª©ng; m·ªôt s·ªë lo√†i c√≥ h√†nh vi b·∫£o v·ªá t·ªï. Vai tr√≤: ƒÉn c√¥n tr√πng v√† g√≥p ph·∫ßn ƒëi·ªÅu h√≤a qu·∫ßn th·ªÉ. Ghi ch√∫: c·∫ßn x√°c ƒë·ªãnh chi/lo√†i ƒë·ªÉ m√¥ t·∫£ ch√≠nh x√°c.",

  // B∆∞·ªõm
  "buom": "B∆∞·ªõm (Lepidoptera) ‚Äî L·ªõp: C√¥n tr√πng (Insecta). B∆∞·ªõm l√† c√¥n tr√πng c√≥ c√°nh ph·ªß v·∫£y m√†u s·∫Øc; v√≤ng ƒë·ªùi c√≥ bi·∫øn th√°i ho√†n ch·ªânh: tr·ª©ng ‚Üí s√¢u b∆∞·ªõm (·∫•u tr√πng) ‚Üí nh·ªông ‚Üí tr∆∞·ªüng th√†nh. M√¥i tr∆∞·ªùng s·ªëng: hoa ƒë·ªìng, v∆∞·ªùn, r·ª´ng; g·∫Øn v·ªõi ngu·ªìn hoa ƒë·ªÉ ki·∫øm m·∫≠t. Ch·∫ø ƒë·ªô ƒÉn tr∆∞·ªüng th√†nh: m·∫≠t hoa; ·∫•u tr√πng ƒÉn l√° c√¢y ch·ªß. Vai tr√≤: th·ª• ph·∫•n, ch·ªâ b√°o ƒëa d·∫°ng sinh h·ªçc. Ghi ch√∫: nhi·ªÅu lo√†i ph·ª• thu·ªôc v√†o lo√†i c√¢y k√Ω ch·ªß cho ·∫•u tr√πng.",
  "b∆∞·ªõm": "B∆∞·ªõm (Lepidoptera) ‚Äî L·ªõp: C√¥n tr√πng (Insecta). B∆∞·ªõm l√† c√¥n tr√πng c√≥ c√°nh ph·ªß v·∫£y m√†u s·∫Øc; v√≤ng ƒë·ªùi c√≥ bi·∫øn th√°i ho√†n ch·ªânh: tr·ª©ng ‚Üí s√¢u b∆∞·ªõm (·∫•u tr√πng) ‚Üí nh·ªông ‚Üí tr∆∞·ªüng th√†nh. M√¥i tr∆∞·ªùng s·ªëng: hoa ƒë·ªìng, v∆∞·ªùn, r·ª´ng; g·∫Øn v·ªõi ngu·ªìn hoa ƒë·ªÉ ki·∫øm m·∫≠t. Ch·∫ø ƒë·ªô ƒÉn tr∆∞·ªüng th√†nh: m·∫≠t hoa; ·∫•u tr√πng ƒÉn l√° c√¢y ch·ªß. Vai tr√≤: th·ª• ph·∫•n, ch·ªâ b√°o ƒëa d·∫°ng sinh h·ªçc. Ghi ch√∫: nhi·ªÅu lo√†i ph·ª• thu·ªôc v√†o lo√†i c√¢y k√Ω ch·ªß cho ·∫•u tr√πng.",

  // Ong
  "ong": "Ong (Apidae v√† h·ªç li√™n quan) ‚Äî L·ªõp: C√¥n tr√πng. Ong l√† c√¥n tr√πng c√≥ vai tr√≤ quan tr·ªçng trong th·ª• ph·∫•n; nhi·ªÅu lo√†i s·ªëng th√†nh ƒë√†n (ong m·∫≠t) v·ªõi c·∫•u tr√∫c x√£ h·ªôi ph·ª©c t·∫°p. M√¥i tr∆∞·ªùng: v∆∞·ªùn hoa, r·ª´ng, c√°nh ƒë·ªìng. Ch·∫ø ƒë·ªô ƒÉn: m·∫≠t hoa v√† ph·∫•n hoa. Sinh s·∫£n: t·ªï ch·ª©c x√£ h·ªôi ph·ª©c t·∫°p, ong ch√∫a ƒë·∫£m nhi·ªám sinh s·∫£n. Vai tr√≤: th·ª• ph·∫•n c√¢y ƒÉn qu·∫£ v√† hoa, s·∫£n xu·∫•t m·∫≠t. Ghi ch√∫: suy gi·∫£m qu·∫ßn th·ªÉ ong do thu·ªëc tr·ª´ s√¢u v√† m·∫•t m√¥i tr∆∞·ªùng s·ªëng l√† m·ªëi lo ng·∫°i to√†n c·∫ßu.",
  
  // Ki·∫øn
  "kien": "Ki·∫øn (Formicidae) ‚Äî L·ªõp: C√¥n tr√πng. Ki·∫øn l√† c√¥n tr√πng x√£ h·ªôi, s·ªëng th√†nh ƒë√†n l·ªõn v·ªõi ph√¢n c√¥ng lao ƒë·ªông; th√¢n nh·ªè, kh·ªèe, c√≥ nhi·ªÅu lo√†i th√≠ch nghi v·ªõi nhi·ªÅu m√¥i tr∆∞·ªùng. M√¥i tr∆∞·ªùng: ƒë·∫•t, r·ª´ng, ƒë√¥ th·ªã. Ch·∫ø ƒë·ªô ƒÉn: r·∫•t ƒëa d·∫°ng ‚Äî ph·∫•n, m·∫≠t, c√¥n tr√πng, ch·∫•t h·ªØu c∆°; m·ªôt s·ªë lo√†i chƒÉn r·ªáp ƒë·ªÉ l·∫•y m·∫≠t. Sinh s·∫£n: c·∫•u tr√∫c c·ªông ƒë·ªìng v·ªõi ki·∫øn ch√∫a sinh s·∫£n. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆°, c·∫£i t·∫°o ƒë·∫•t, ki·ªÉm so√°t d·ªãch h·∫°i. Ghi ch√∫: m·ªôt s·ªë lo√†i g√¢y h·∫°i n√¥ng nghi·ªáp ho·∫∑c x√¢m h·∫°i khu v·ª±c m·ªõi.",
  "ki·∫øn": "Ki·∫øn (Formicidae) ‚Äî L·ªõp: C√¥n tr√πng. Ki·∫øn l√† c√¥n tr√πng x√£ h·ªôi, s·ªëng th√†nh ƒë√†n l·ªõn v·ªõi ph√¢n c√¥ng lao ƒë·ªông; th√¢n nh·ªè, kh·ªèe, c√≥ nhi·ªÅu lo√†i th√≠ch nghi v·ªõi nhi·ªÅu m√¥i tr∆∞·ªùng. M√¥i tr∆∞·ªùng: ƒë·∫•t, r·ª´ng, ƒë√¥ th·ªã. Ch·∫ø ƒë·ªô ƒÉn: r·∫•t ƒëa d·∫°ng ‚Äî ph·∫•n, m·∫≠t, c√¥n tr√πng, ch·∫•t h·ªØu c∆°; m·ªôt s·ªë lo√†i chƒÉn r·ªáp ƒë·ªÉ l·∫•y m·∫≠t. Sinh s·∫£n: c·∫•u tr√∫c c·ªông ƒë·ªìng v·ªõi ki·∫øn ch√∫a sinh s·∫£n. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆°, c·∫£i t·∫°o ƒë·∫•t, ki·ªÉm so√°t d·ªãch h·∫°i. Ghi ch√∫: m·ªôt s·ªë lo√†i g√¢y h·∫°i n√¥ng nghi·ªáp ho·∫∑c x√¢m h·∫°i khu v·ª±c m·ªõi.",

  // Gi√°n
  "gian": "Gi√°n (Blattodea) ‚Äî L·ªõp: C√¥n tr√πng. Gi√°n l√† lo√†i c√¥n tr√πng s·ªëng ƒë∆∞·ª£c trong ƒëi·ªÅu ki·ªán kh·∫Øc nghi·ªát, th∆∞·ªùng ho·∫°t ƒë·ªông v·ªÅ ƒë√™m; c∆° th·ªÉ d·∫πp, ch√¢n ch·∫°y nhanh. M√¥i tr∆∞·ªùng: nh√† ·ªü, khu ƒë√¥ th·ªã, m√¥i tr∆∞·ªùng ·∫©m. Ch·∫ø ƒë·ªô ƒÉn: x√°c h·ªØu c∆°, v·ª•n th·ª±c ph·∫©m. Sinh s·∫£n: ƒë·∫ª tr·ª©ng trong bao ootheca; sinh s·∫£n nhanh. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆° nh∆∞ng c≈©ng l√† v·∫≠t g√¢y h·∫°i v√† truy·ªÅn b·ªánh trong m√¥i tr∆∞·ªùng s·ªëng con ng∆∞·ªùi. Ghi ch√∫: ki·ªÉm so√°t sinh v·∫≠t g√¢y h·∫°i quan tr·ªçng trong m√¥i tr∆∞·ªùng sinh ho·∫°t.",
  "gi√°n": "Gi√°n (Blattodea) ‚Äî L·ªõp: C√¥n tr√πng. Gi√°n l√† lo√†i c√¥n tr√πng s·ªëng ƒë∆∞·ª£c trong ƒëi·ªÅu ki·ªán kh·∫Øc nghi·ªát, th∆∞·ªùng ho·∫°t ƒë·ªông v·ªÅ ƒë√™m; c∆° th·ªÉ d·∫πp, ch√¢n ch·∫°y nhanh. M√¥i tr∆∞·ªùng: nh√† ·ªü, khu ƒë√¥ th·ªã, m√¥i tr∆∞·ªùng ·∫©m. Ch·∫ø ƒë·ªô ƒÉn: x√°c h·ªØu c∆°, v·ª•n th·ª±c ph·∫©m. Sinh s·∫£n: ƒë·∫ª tr·ª©ng trong bao ootheca; sinh s·∫£n nhanh. Vai tr√≤: ph√¢n h·ªßy h·ªØu c∆° nh∆∞ng c≈©ng l√† v·∫≠t g√¢y h·∫°i v√† truy·ªÅn b·ªánh trong m√¥i tr∆∞·ªùng s·ªëng con ng∆∞·ªùi. Ghi ch√∫: ki·ªÉm so√°t sinh v·∫≠t g√¢y h·∫°i quan tr·ªçng trong m√¥i tr∆∞·ªùng sinh ho·∫°t.",

  // S√¢u (s√¢u b∆∞·ªõm / s√¢u non)
  "sau": "S√¢u (·∫•u tr√πng c√¥n tr√πng, v√≠ d·ª• s√¢u b∆∞·ªõm, s√¢u b·ªç) ‚Äî L·ªõp: C√¥n tr√πng. 'S√¢u' th∆∞·ªùng ch·ªâ giai ƒëo·∫°n ·∫•u tr√πng c·ªßa b∆∞·ªõm, b·ªç c√°nh m·ªÅm, b·ªç r·∫ßy... Ch√∫ng c√≥ th√¢n m·ªÅm, ƒÉn l√° v√† m√¥ th·ª±c v·∫≠t, c√≥ vai tr√≤ c·∫£ t√≠ch c·ª±c (m·ªìi cho chim, k√Ω sinh) v√† ti√™u c·ª±c (g√¢y h·∫°i c√¢y tr·ªìng). M√¥i tr∆∞·ªùng: th·ª±c v·∫≠t v√† m√¥i tr∆∞·ªùng tr·ªìng tr·ªçt. Sinh s·∫£n: ph√°t tri·ªÉn qua bi·∫øn th√°i; ·∫•u tr√πng -> nh·ªông -> tr∆∞·ªüng th√†nh. Vai tr√≤: th√†nh ph·∫ßn quan tr·ªçng c·ªßa chu·ªói th·ª©c ƒÉn; nhi·ªÅu lo√†i s√¢u l√† d·ªãch h·∫°i n√¥ng nghi·ªáp. Ghi ch√∫: qu·∫£n l√Ω s√¢u h·∫°i d·ª±a tr√™n sinh th√°i h·ªçc v√† ki·ªÉm so√°t sinh h·ªçc.",
  "s√¢u": "S√¢u (·∫•u tr√πng c√¥n tr√πng, v√≠ d·ª• s√¢u b∆∞·ªõm, s√¢u b·ªç) ‚Äî L·ªõp: C√¥n tr√πng. 'S√¢u' th∆∞·ªùng ch·ªâ giai ƒëo·∫°n ·∫•u tr√πng c·ªßa b∆∞·ªõm, b·ªç c√°nh m·ªÅm, b·ªç r·∫ßy... Ch√∫ng c√≥ th√¢n m·ªÅm, ƒÉn l√° v√† m√¥ th·ª±c v·∫≠t, c√≥ vai tr√≤ c·∫£ t√≠ch c·ª±c (m·ªìi cho chim, k√Ω sinh) v√† ti√™u c·ª±c (g√¢y h·∫°i c√¢y tr·ªìng). M√¥i tr∆∞·ªùng: th·ª±c v·∫≠t v√† m√¥i tr∆∞·ªùng tr·ªìng tr·ªçt. Sinh s·∫£n: ph√°t tri·ªÉn qua bi·∫øn th√°i; ·∫•u tr√πng -> nh·ªông -> tr∆∞·ªüng th√†nh. Vai tr√≤: th√†nh ph·∫ßn quan tr·ªçng c·ªßa chu·ªói th·ª©c ƒÉn; nhi·ªÅu lo√†i s√¢u l√† d·ªãch h·∫°i n√¥ng nghi·ªáp. Ghi ch√∫: qu·∫£n l√Ω s√¢u h·∫°i d·ª±a tr√™n sinh th√°i h·ªçc v√† ki·ªÉm so√°t sinh h·ªçc."
};


/* ========== Popup ========== */
let lastShownKey=null,lastShownTime=0,POPUP_MIN_INTERVAL_MS=4000;
function showPopup(animalName, percent, infoText){ const now=Date.now(); const key=(animalName||'').toLowerCase().trim(); if(lastShownKey===key && (now-lastShownTime)<POPUP_MIN_INTERVAL_MS) return; lastShownKey=key; lastShownTime=now; popupTitle.textContent = `LO√ÄI: ${animalName.toUpperCase()}`; popupPercent.textContent = `${percent}%`; popupInfo.textContent = infoText || ''; popupOverlay.classList.add('show'); popupOverlay.setAttribute('aria-hidden','false'); }
function hidePopup(){ popupOverlay.classList.remove('show'); popupOverlay.setAttribute('aria-hidden','true'); }
popupClose.addEventListener('click', hidePopup);
popupOverlay.addEventListener('click', (e)=>{ if(e.target===popupOverlay) hidePopup(); });

/* ========== Prediction + background save (fast) ========== */
async function predictImageElement(imgElem, opts={fast:false}) {
  if(!model) return;
  try {
    setStatus('ƒêang ph√¢n t√≠ch...');
    const smallCanvas=document.createElement('canvas'); const s=smallPredictSize; smallCanvas.width=s; smallCanvas.height=s;
    const sx=imgElem.naturalWidth||imgElem.width; const sy=imgElem.naturalHeight||imgElem.height;
    const ctx=smallCanvas.getContext('2d'); const ratio=Math.max(s/sx, s/sy); const dw=sx*ratio, dh=sy*ratio;
    ctx.drawImage(imgElem, (s-dw)/2, (s-dh)/2, dw, dh);
    const prediction = await model.predict(smallCanvas);
    let highest={className:'Ch∆∞a r√µ',probability:0};
    for(let i=0;i<prediction.length;i++){ const p=prediction[i]; const pct=(p.probability*100).toFixed(1)+'%'; const child=labelContainer.childNodes[i]; if(child) child.innerHTML = `${p.className}: <strong>${pct}</strong>`; if(p.probability>highest.probability) highest=p; }
    console.log('Fast prediction:', highest);
    if(highest.probability>0.7){
      const name=String(highest.className||'').trim(); const percent=(highest.probability*100).toFixed(1);
      const keyRaw=name.toLowerCase(); const keyStripped=stripDiacritics(keyRaw); const classInfo = infoMap[keyRaw] || infoMap[keyStripped] || '';
      if(classInfo) infoElement.innerHTML = `<strong>Lo√†i: ${name.toUpperCase()}</strong><br>${classInfo}`; else infoElement.innerHTML = `<strong>Lo√†i: ${name.toUpperCase()}</strong>`;
      showPopup(name, percent, classInfo);
      // background save
      if(!ensureStudentInfoBeforeAction()){ setStatus('Vui l√≤ng nh·∫≠p th√¥ng tin h·ªçc sinh ƒë·ªÉ l∆∞u.'); } else {
        setStatus('ƒêang l∆∞u v√†o Th∆∞ vi·ªán (n·ªÅn)...');
        let blob=null;
        if(uploadedFile instanceof File) blob=uploadedFile;
        else {
          const upCanvas=document.createElement('canvas'); const maxSide=1024; const iw=imgElem.naturalWidth||imgElem.width; const ih=imgElem.naturalHeight||imgElem.height; const scale=Math.min(1, maxSide/Math.max(iw,ih));
          upCanvas.width=Math.round(iw*scale); upCanvas.height=Math.round(ih*scale); upCanvas.getContext('2d').drawImage(imgElem,0,0,upCanvas.width,upCanvas.height);
          blob = await new Promise(r=>upCanvas.toBlob(r,'image/jpeg',0.85));
        }
        uploadToCloudinaryAndSave(blob, name, percent, prediction.map(p=>({className:p.className, probability:p.probability})))
        .then(()=>{ setStatus('ƒê√£ l∆∞u v√†o Th∆∞ vi·ªán.'); if(libraryOverlay.classList.contains('show')) loadLibraryOnce(); fetchAndRenderStats(); })
        .catch(err=>{ console.error('Background save error',err); setStatus('L∆∞u v√†o Th∆∞ vi·ªán th·∫•t b·∫°i (xem console).', true); });
      }
    } else { infoElement.innerHTML='X√°c su·∫•t kh√¥ng ƒë·ªß cao. Vui l√≤ng th·ª≠ ·∫£nh r√µ h∆°n.'; setStatus('X√°c su·∫•t th·∫•p.'); }
  } catch(err){ console.error(err); setStatus('L·ªói khi ph√¢n t√≠ch ·∫£nh (xem console).', true); }
}

/* ========== Cloudinary upload + Apps Script JSONP save ========== */
function saveMetadataViaJSONP(params, callback) {
  const query = Object.keys(params).map(k=>`${encodeURIComponent(k)}=${encodeURIComponent(params[k])}`).join('&');
  const cbName = 'cb_' + Math.random().toString(36).slice(2);
  window[cbName] = function(result){ try{ callback && callback(null,result); } finally{ delete window[cbName]; script.remove(); } };
  const script = document.createElement('script');
  script.src = `${APPS_SCRIPT_URL}?${query}&callback=${cbName}`;
  script.onerror = function(){ callback && callback(new Error('JSONP request failed')); delete window[cbName]; script.remove(); };
  document.body.appendChild(script);
}
async function uploadToCloudinaryAndSave(fileOrBlob, resultName, resultProb, rawPredictions) {
  if(!fileOrBlob) throw new Error('No file/blob to upload');
  const uploadUrl = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`;
  const fd = new FormData(); fd.append('file', fileOrBlob); fd.append('upload_preset', CLOUDINARY_UNSIGNED_UPLOAD_PRESET);
  const cloudRes = await fetch(uploadUrl, { method:'POST', body: fd });
  if(!cloudRes.ok){ const txt = await cloudRes.text(); throw new Error('Cloudinary upload failed: '+cloudRes.status+' '+txt); }
  const cloudJson = await cloudRes.json(); const imageUrl = cloudJson.secure_url || cloudJson.url;
  const student = getStudentInfo() || { name:'Unknown', class:'Unknown' };
  const payload = { student_name: student.name, student_class: student.class, image_url: imageUrl, result_name: resultName, result_prob: resultProb, raw_predictions: JSON.stringify(rawPredictions||[]) };
  return new Promise((resolve,reject)=>{ saveMetadataViaJSONP(payload, (err,res)=>{ if(err){ console.error('JSONP error',err); return reject(err); } resolve({ cloud:cloudJson, sheet:res }); }); });
}

/* ========== Visit increment (JSONP) ========== */
function incrementVisit() {
  return new Promise((resolve,reject)=> {
    const cbName = 'cb_visit_' + Math.random().toString(36).slice(2);
    window[cbName] = function(result){ try{ resolve(result); } finally { delete window[cbName]; script.remove(); } };
    const script = document.createElement('script');
    script.src = `${APPS_SCRIPT_URL}?mode=visit&callback=${cbName}`;
    script.onerror = ()=>{ reject(new Error('Visit JSONP failed')); delete window[cbName]; script.remove(); };
    document.body.appendChild(script);
  }).catch(err=>{ console.warn('incrementVisit failed',err); return null; });
}

/* ========== Stats fetch & render ========== */
async function fetchAndRenderStats() {
  try {
    const res = await fetch(APPS_SCRIPT_URL + '?action=stats', { method:'GET' });
    if(!res.ok){ console.error('stats fetch error', res.status); return; }
    const data = await res.json();
    // expect { visits_count: number, library_count: number, students_count: number, library: [...] }
    statStudents.textContent = data.students_count != null ? data.students_count : '‚Äî';
    statRecognitions.textContent = data.library_count != null ? data.library_count : '‚Äî';
    statVisits.textContent = data.visits_count != null ? data.visits_count : '‚Äî';
    // optionally set library render
    renderLibrary(data.library || []);
  } catch(err){ console.error('fetchAndRenderStats error',err); }
}

/* ========== Library load & render (legacy) ========== */
async function loadLibraryOnce() {
  // fetch stats endpoint which also returns library; reuse same endpoint
  await fetchAndRenderStats();
}
function renderLibrary(items) {
  libraryList.innerHTML = '';
  if(!items || items.length===0){ libraryList.innerHTML = '<p>KH√îNG C√ì B·∫¢N GHI</p>'; return; }
  items.forEach(item => {
    const rec = document.createElement('div'); rec.className='record';
    const img = document.createElement('img'); img.src = item.image_url || ''; rec.appendChild(img);
    const meta = document.createElement('div'); meta.className = 'meta';
    const dateText = item.created_at ? new Date(item.created_at).toLocaleString() : '';
    meta.innerHTML = `<b>${item.result_name || 'Kh√¥ng r√µ'}</b>
                      <div>X√°c su·∫•t: ${item.result_prob || ''}%</div>
                      <div>H·ªçc sinh: ${item.student_name || ''} - L·ªõp: ${item.student_class || ''}</div>
                      <div>Th·ªùi gian: ${dateText}</div>`;
    rec.appendChild(meta); libraryList.appendChild(rec);
  });
}

/* ========== UI handlers ========== */
libraryBtn.addEventListener('click', ()=>{ libraryOverlay.classList.add('show'); libraryOverlay.setAttribute('aria-hidden','false'); loadLibraryOnce(); });
libraryClose.addEventListener('click', ()=>{ libraryOverlay.classList.remove('show'); libraryOverlay.setAttribute('aria-hidden','true'); });

/* ========== Camera loop (unchanged) ========== */
async function loop() {
  if(!model){ window.requestAnimationFrame(loop); return; }
  try{
    const source = videoElem;
    if(source && !source.paused && !source.ended){
      const prediction = await model.predict(source);
      let highest={className:'Ch∆∞a r√µ',probability:0};
      for(let i=0;i<prediction.length;i++){ const p=prediction[i]; const pct=(p.probability*100).toFixed(1)+'%'; const child=labelContainer.childNodes[i]; if(child) child.innerHTML = `${p.className}: <strong>${pct}</strong>`; if(p.probability>highest.probability) highest=p; }
      if(highest.probability>0.7){
        const name=String(highest.className||'').trim(); const percent=(highest.probability*100).toFixed(1);
        const keyRaw=name.toLowerCase(), keyStripped=stripDiacritics(keyRaw);
        const classInfo = infoMap[keyRaw] || infoMap[keyStripped] || '';
        if(classInfo) infoElement.innerHTML = `<strong>Lo√†i: ${name.toUpperCase()}</strong><br>${classInfo}`; else infoElement.innerHTML = `<strong>Lo√†i: ${name.toUpperCase()}</strong>`;
        showPopup(name, percent, classInfo);
      } else {
        infoElement.innerHTML = 'ƒêang ch·ªù nh·∫≠n d·∫°ng ho·∫∑c x√°c su·∫•t kh√¥ng ƒë·ªß cao. Vui l√≤ng ƒë∆∞a h√¨nh ·∫£nh r√µ r√†ng h∆°n v√†o camera.';
      }
    }
  } catch(err){ console.warn('loop error',err); }
  window.requestAnimationFrame(loop);
}

/* ========== Cleanup ========== */
window.addEventListener('beforeunload', stopCurrentStream);
window.addEventListener('pagehide', stopCurrentStream);
</script>
</body>
</html>
